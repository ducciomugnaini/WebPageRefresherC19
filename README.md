# WebPageRefresherC19

Tailored to check if the reservation is active on [Covid Site](https://prenotavaccino.sanita.toscana.it/#/home).

Selenium has been used to avoid the message _enable JavaScript to view the page content_.

---

## Utilities
[Selenium](https://www.javatpoint.com/selenium-csharp)  
[Chrome driver](https://chromedriver.chromium.org/downloads)  
[Visual studio code luncher](https://stackoverflow.com/questions/61937342/launch-visual-studio-code-programmatically)  

[Send mail with google](https://stackoverflow.com/questions/18503333/the-smtp-server-requires-a-secure-connection-or-the-client-was-not-authenticated)  

[HtmlAgilityPack](https://dotnetfiddle.net/51mdl7)  
[WebCrawler](https://github.com/abdulateef/webcrawling/blob/master/CrawlerDemo/Program.cs)  

---

## Workaround Hints

[Workaround ‘enable JavaScript to view the page content’ when Web Scraping in C#](https://medium.com/@jaethedeveloper/workaround-enable-javascript-to-view-the-page-content-when-web-scraping-in-c-2b30b35f625b)  
[Scraping webpage generated by javascript with C#](https://stackoverflow.com/questions/24288726/scraping-webpage-generated-by-javascript-with-c-sharp)

---

## Google and send email _(from [stackoverflow.com](https://stackoverflow.com/questions/18503333/the-smtp-server-requires-a-secure-connection-or-the-client-was-not-authenticated))_

Google may block sign in attempts from some apps or devices that do not use modern security standards. Since these apps and devices are easier to break into, blocking them helps keep your account safer.

Some examples of apps that do not support the latest security standards include:
- The Mail app on your iPhone or iPad with iOS 6 or below
- The Mail app on your Windows phone preceding the 8.1 release
- Some Desktop mail clients like Microsoft Outlook and Mozilla Thunderbird

Therefore, you have to enable Less Secure Sign-In (or Less secure app access) in your google account.

After sign into google account, go to:

https://www.google.com/settings/security/lesssecureapps  
or  
https://myaccount.google.com/lesssecureapps  

In C#, you can use the following code:

```csharp
using (MailMessage mail = new MailMessage())
{
    mail.From = new MailAddress("email@gmail.com");
    mail.To.Add("somebody@domain.com");
    mail.Subject = "Hello World";
    mail.Body = "<h1>Hello</h1>";
    mail.IsBodyHtml = true;
    mail.Attachments.Add(new Attachment("C:\\file.zip"));

    using (SmtpClient smtp = new SmtpClient("smtp.gmail.com", 587))
    {
        smtp.Credentials = new NetworkCredential("email@gmail.com", "password");
        smtp.EnableSsl = true;
        smtp.Send(mail);
    }
}
```
